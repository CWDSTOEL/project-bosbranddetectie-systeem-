<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <title>Early Fire Warning</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
  <script>
    if (localStorage.getItem("loggedIn") !== "true") {
      window.location.href = "login.html";
    }
  </script>

  <header>
    <div class="header-content">
      <h1>Early Fire Warning</h1>
      <a href="#" class="logout-button" onclick="logout()">Logout</a>
    </div>
  </header>

  <section class="alert-feed">
    <h2>Live Waarschuwingen</h2>
    <div id="alerts">
      <p class="alert-message">Er zijn momenteel geen actieve waarschuwingen.</p>
    </div>
  </section>

  <section class="map-section">
    <h2>Live Kaart</h2>
    <div id="liveMap"></div>
  </section>

  <section class="send-warning">
    <h2>Waarschuwing Versturen</h2>
    <form id="warningForm">
      <label for="radius">Radius (km):</label>
      <input type="number" id="radius" required>
      <label for="message">Bericht:</label>
      <textarea id="message" rows="4" required placeholder="Typ hier je waarschuwing..."></textarea>
      <button type="submit">Stuur waarschuwing</button>
    </form>
  </section>

  <section class="sensor-visuals">
    <h2>Sensoroverzicht</h2>
    <div class="graph-container">
      <p>Hier komt straks een grafiek met temperatuur- of rookdata.</p>
      <canvas id="sensorChart"></canvas>
    </div>
    <div class="table-container">
      <p>Tabel met actuele sensorwaarden:</p>
      <table>
        <thead>
          <tr>
            <th>Sensor ID</th>
            <th>Temperatuur (°C)</th>
            <th>Luchtvochtigheid (%)</th>
            <th>Rookconcentratie</th>
            <th>Laatste update</th>
          </tr>
        </thead>
        <tbody id="sensorTableBody">
          <tr><td colspan="5">Nog geen data beschikbaar</td></tr>
        </tbody>
      </table>
    </div>
  </section>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    const map = L.map('liveMap').setView([52.1, 5.1], 7);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);
    L.marker([52.1, 5.1]).addTo(map).bindPopup('Brandmelding bij sensor #12').openPopup();

    document.getElementById("warningForm").addEventListener("submit", function (e) {
      e.preventDefault();
      const radius = document.getElementById("radius").value;
      const message = document.getElementById("message").value;
      const alertsDiv = document.getElementById("alerts");
      const p = document.createElement("p");
      p.className = "alert-message";
      p.innerHTML = `<span class="message-text">Melding verzonden binnen ${radius} km: ${message}</span>
                     <button class="close-alert" onclick="this.parentElement.remove()">×</button>`;
      alertsDiv.prepend(p);
      this.reset();
    });

    function logout() {
      localStorage.removeItem("loggedIn");
      window.location.href = "index.html";
    }
  </script>
</body>
</html>
